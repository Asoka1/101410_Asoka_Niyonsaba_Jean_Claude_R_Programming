---
title: "Second Session"
author: "101410 - Asoka Niyonsaba Jean Claude"
date: "2025-10-16"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# CLASS 2 & 3:DATA VISUALIZATION 
# AND DATA MANAGEMENT

```{r}
data1 <- read.table(text="
Sept_2022 Oct_2022 Nov_2022 Dec_2022 Jan_2023 Feb_2023 Mar_2023 Apr_2023 May_2023 June_2023
1 4 6 30 140 67 47 23 39 134 80
2 10 2 29 164 72 81 28 63 211 132
", header = TRUE)

barplot(as.matrix(data1),
        main = "Confirmed cases Vs Gender",
        beside = TRUE,
        col = c("gold3", "red"))

legend("topright",
       c("Male", "Female"),
       cex = 0.8,
       bty = "n",
       fill = c("gold3", "red"))
```
```{r}
# Create the dataset correctly
data3 <- read.table(text = "
Month       Male  Female
Sept_2022   867   582
Oct_2022    1802  12003
Nov_2022    3059  9205
Dec_2022    5346  7269
Jan_2023    5933  3245
Feb_2023    842   436
Mar_2023    1805  11785
Apr_2023    3508  10908
May_2023    4902  7883
June_2023   5901  4646
", header = TRUE)

# View data
print(data3)

# Create bar plot
barplot(
  as.matrix(t(data3[, -1])),                     # transpose so months are grouped
  beside = TRUE,
  col = c("blue", "purple"),
  names.arg = data3$Month,
  main = "COVID-19 Tests vs Gender",
  las = 2,                                       # make month labels vertical
  cex.names = 0.8
)

# Add legend
legend("topleft",
       legend = c("Male", "Female"),
       cex = 1.2,
       bty = "n",
       fill = c("blue", "purple"))

```
```{r}
# Create the dataset correctly
data2 <- read.table(text = "
Month       Less_15  Age_15_49  Above_50
Sept_2022   0        11         3
Oct_2022    0        3          5
Nov_2022    1        41         17
Dec_2022    9        242        53
Jan_2023    8        104        27
Feb_2023    7        78         43
Mar_2023    1        44         6
Apr_2023    4        86         12
May_2023    11       244        90
June_2023   22       147        43
", header = TRUE)

# View the data
print(data2)

# Create bar plot
barplot(
  as.matrix(t(data2[, -1])),          # transpose numeric data for side-by-side bars
  beside = TRUE,
  col = c("green", "blue", "purple"),
  names.arg = data2$Month,
  main = "Confirmed COVID-19 Cases vs Age Categories",
  las = 2,                            # rotate month labels for clarity
  cex.names = 0.8
)

# Add legend
legend("topleft",
       legend = c("Less than 15 years", "15–49 years", "Above 50 years"),
       cex = 1.2,
       bty = "n",
       fill = c("green", "blue", "purple"))

```
```{r}
# Define the months
months <- c("Sept_2022", "Oct_2022", "Nov_2022", "Dec_2022", 
            "Jan_2023", "Feb_2023", "Mar_2023", "Apr_2023", 
            "May_2023", "June_2023")

# Data for confirmed COVID cases
Confirmed_covid <- c(14, 8, 59, 304, 139, 128, 51, 102, 345, 212)

# Data for patients who received treatment
treatment <- c(12, 0, 26, 217, 104, 57, 12, 47, 23, 20)

# Create the line plot
plot(Confirmed_covid,
     type = "l",               # line plot
     pch = 21,                 # point style
     col = "red",              # line color
     ylim = c(0, 350),         # y-axis range
     xaxt = "n",               # suppress x-axis temporarily
     ylab = "Number of Patients",
     main = "Confirmed COVID-19 Cases vs Treatment")

# Add the second line (treatment)
lines(treatment, col = "blue", lty = 2, lwd = 2)

# Add x-axis labels
axis(1, at = 1:10, labels = months, las = 2, cex.axis = 0.8)

# Add legend
legend("topleft",
       legend = c("Confirmed Cases", "Received Treatment"),
       col = c("red", "blue"),
       lty = c(1, 2),
       lwd = 2,
       bty = "n",
       cex = 0.8)

```
```{r}
# Define months
months <- c("Sept_2022", "Oct_2022", "Nov_2022", "Dec_2022",
            "Jan_2023", "Feb_2023", "Mar_2023", "Apr_2023",
            "May_2023", "June_2023")

# Define number of COVID-19 tests
number_of_test <- c(1709, 1018, 3607, 23788, 6567, 20113, 10248, 15152, 11834, 7891)

# Create line and point plot
plot(number_of_test,
     type = "o",                # "o" means line + points
     col = "blue",              # line color
     pch = 16,                  # solid circle points
     ylim = c(0, 24000),        # y-axis limits
     xaxt = "n",                # hide x-axis for now
     ylab = "Number of Tests",
     main = "COVID-19 Tests Over Time")

# Add month names on x-axis
axis(1, at = 1:10, labels = months, las = 2, cex.axis = 0.8)

```
 ggplot2
 ggplot2 provides a set of tools that allows you to visualize complex data sets in a
 new creative way-some work need some packages to get done.-some of the graph
 are created using R’s base graphics system
```{r}
###install.packages("ggplot2")
 library(ggplot2)
data(mtcars)
 #dotchart(mtcars$mpg,labels=row.names(mtcars),ce#x = 0.,main="miles per Gallon of car #model",xlab = "MPG")
 table(mtcars$cyl)
 #barplot(mtcars$cyl)
 barplot(table(mtcars$cyl),main="Distribution of car Cylinder counts",xlab="Number of cylinders",ylab = "Number of cars")
```
```{r}
barplot(table(mtcars$cyl),main="Distribution of car Cylinder counts",xlab="Number of cylinders",ylab = "Number of cars",horiz=TRUE)
```
```{r}
plot(mtcars$mpg~mtcars$wt,main="Automobile Data",xlab="Weight",ylab=" Miles per Gallon")
```
 
```{r}
plot(mtcars$mpg~mtcars$wt,main="Automobile Data",xlab="Weight",ylab=" Miles per Gallon")
plot(mtcars$mpg~mtcars$wt,pch=17,main="Automobile Data",xlab="Weight",ylab=" Miles per Gallon")
```
```{r}
plot(mtcars$mpg~mtcars$wt,pch=21,main="Automobile Data",xlab="Weight",ylab=" Miles per Gallon")
```
```{r}
plot(mtcars$mpg~mtcars$wt,type="l", lty=2, lwd=2,col="red",main="Automobile Data",xlab="Weight",ylab=" Miles per Gallon")
```
```{r}
 ##plot created up to that point
 library(ggplot2)
 ggplot(data=mtcars, aes(x=wt,y=mpg))+geom_point()+
 labs(title = "Automobile Data",x="Weight",y="Miles per Galon")
```
```{r}
ggplot(data=mtcars, aes(x=wt,y=mpg))+geom_point(pch=17,color="blue",size=1)+
 geom_smooth(method="lm",color="green")+
 labs(title = "Automobile Data",x="Weight",y="Miles per Galon")
 ## `geom_smooth()` using formula = 'y ~ x'
```
```{r}
f0<-ggplot(data=mtcars, aes(x=wt,y=mpg))+geom_point(shape=24, fill=1,size=1)+
 geom_smooth(method="lm",color="blue")
 f0
 ## `geom_smooth()` using formula = 'y ~ x'
```
```{r}
f1<-f0+theme_bw()
f1
 ## `geom_smooth()` using formula = 'y ~ x'
```
```{r}
f2<-f1+theme(panel.grid = element_line(linetype = "dotted",color = "Black"))
 f2
 ## `geom_smooth()` using formula = 'y ~ x'
```
```{r}
data(mtcars)
 mtcars$am<-factor(mtcars$am, levels =c(0,1),
 labels= c("Automatic","Manual"))
 mtcars$vs<-factor(mtcars$vs, levels =c(0,1),
 labels=c("V-Engine","Straight Engine"))
 mtcars$cyl<-factor(mtcars$cyl)
 ggplot(data=mtcars,aes(x=hp,y=mpg,shape=cyl,color=cyl))+
 geom_point(size=3)+
 facet_grid(vs~am)+
 labs(title = "Automobile Data by Engine Type",x="HorsePower",y="Miles
 per Gallon")
```
```{r}
data(singer,package="lattice")
 ggplot(singer,aes(x=voice.part,y=height))+geom_boxplot()
```
 Usethefollowingfunction:
 geom_bar()geom_boxplot()geom_density()geom_histogram()geom_hline()
 geom_jitter()geom_line()#geom_point()geom_rug()#geom_smooth()geom_text()
 geom_violin()geom_vline()##Basicdatamanagement
 cbindandrbind
 Whilecombiningcolumnwise,thenumberofrowsmustmatchbutrownamesare
 ignored.whencombiningrow-wise,boththenumberandthenamesofcolumns
 mustmatch.
 
```{r}
data2<-data.frame(x=1:3,y=c("a","b","c"))
str(data2)
(cbind(data2,data.frame(z=3:1)))
(rbind(data2,data.frame(x=10,y="z")))
```
```{r}
variable.names(women)
head(women,n=5)
tail(women)
```
```{r}
women[,1]
summary(women$WEIGHT)
length(women$WEIGHT)
women[,-1]

```
```{r}
## Subsetting

manager<-c(1,2,3,4,5)
country<-c("US","US","UK","UK","UK")
gender<-c("M","F","F","M","F")
age<-c(32,45,25,39,99)
q1<-c(5,3,3,3,2)
q2<-c(4,5,5,3,2)
q3<-c(5,2,5,4,1)
q4<-c(5,5,5,NA,2)
q5<-c(5,5,2,NA,1)
leadership<-data.frame(manager,country,gender,age,q1,q2,q3,q4,q5,stringsAsFactors=FALSE)
leadership<-data.frame(manager,country,gender,age,q1,q2,q3,q4,q5)
str(leadership)

```
```{r}
names(leadership)
```
 What you can do-combine the score of the five questions-handle the missing
 values-createadatasetofwhatyouwant-createagegrouporagecategories-99
 indicatethevalueismissing
 Missingvalue
```{r}
leadership$age[leadership$age==99]<-NA
leadership$agecat[leadership$age>75]<-"Elder"
leadership$agecat[leadership$age>=35&leadership$age<=75]<-"MiddleAged"
leadership$agecat[leadership$age<35]<-"Young"
```
 
Onewaytohandlemissingvalue
Deletingallobservationswithmissingdata(Listwisedeletion)isoneoftheseveral
methodsofhandlingincompletedatasets.Note:Youcanalsoreplacingthemissing
valuebytheaverageoftheremainingdata.
```{r}
is.na(leadership[,5:9])
```
```{r}
newdata<-na.omit(leadership)
newdata
```
Sorting data
```{r}
order(leadership$age)
```
```{r}
newdata2<-leadership[order(leadership$age),]
```

Mergingdatasets
Tomergetwodataframehorizontally,youusemerge()function.Inmostcases,two
 dataframesarejoinedbyoneormorecommonkeyvariables.-example1:
 merge(dataframeA,dataframeB,by=“ID”)-example2:
 merge(dataframeA,dataframeB,by=c(“ID”,“country”))
 thesecondmergethetwodataframesbyIDandcountry
 Tojointwodataframe(datasets)vertically,userbind()function:Notethatthetwo
 datasetmusthavethesamevariables
 
```{r}
# Subset(selectingvariables,droppingvariables,selectingobservation)
 newdata3<-leadership[,c(5:9)]
 myvars<-c("q1","q2","q3","q4","q5")
 newdata3<-leadership[myvars]
 newdata4<-leadership[,c(-1,-2)]
 newdata4<-leadership[,-(1:5)]
 newdata5<-leadership[,c(-1,-7)]
 leadership[[4]]
```
```{r}
leadership$age
```
```{r}
newdata6<-leadership[c(-1,-3),]
newdata6<-leadership[c(2,4,5),]
newdata7<-subset(leadership,age>=35|age<24,select=c(q1,q2,q3,q4,q5))
attach(leadership)
```
 
```{r}
#newdata7<-leadership[gender="M"&age>30,]
 newdata7<-leadership[gender=="M"&age>30,]
 detach(leadership)
```
 
 Datamanagementwithdyplr
 Datasourcefromthepackagenycflights13andggplot2Thisdatacontainsall
 336,776flightsthatdepartedfromNewYorkcityin2013.
 Datamanagementwithdyplr
 Datasourcefromthepackagenycflights13andggplot2Thisdatacontainsall
 336,776flightsthatdepartedfromNewyorkcityin2013.
 
```{r}
library(nycflights13)
library(dplyr)
#library(tidyverse)
```
 Thefunctionfilter()
 #rm(list=ls())
 
```{r}
 str(flights)
```
```{r}
#attach(flights)
 jan<-filter(flights,month==1)
 jan
```
```{r}
newyear<-filter(flights,month==1,day==1)
 newyear
```
```{r}
dec25<-filter(flights,month==12,day==25)
 dec25
```
```{r}
jan_dec<-filter(flights,month==1|month==12)
 jan_dec
```
 
```{r}
nov_dec<-filter(flights,month%in%c(11,12))
 #detach(flights)
```
 
 Thefunctionarrange()
 Thischangetheorder
 
```{r}
data_10<-arrange(flights,year,month,day)
 arrange(flights,desc(arr_delay))
```
 
  Thefunctionselect
 Thishelpstoselectsonlythevariablesyouareinterestedin
 
```{r}
time_var<-select(flights,year,month,day)
 select(flights,year:day)
```
```{r}
 select(flights,-(year:day))
```
Thefunctionmutate
ThisisusefulinaddinganewVariable

```{r}
##createasmalldataset
 flights2<-select(flights,year:day,ends_with("delay"),distance,air_time)
 (mutate(flights2,gain=arr_delay-dep_delay,speed=distance/air_time*60))
```


